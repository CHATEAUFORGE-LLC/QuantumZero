---
config:
  layout: elk
---
flowchart TB
 subgraph Local_Security["Hardware Security Layer"]
        SE["Secure Enclave /<br>Android Keystore"]
  end
 subgraph App_Logic["Application Logic"]
        DID_Mod["DID Management<br>DIDKit/Hyperledger Aries"]
        ZKP_Gen["ZKP Generator<br>Mopro / Noir DSL"]
        Local_DB[("Local Storage<br>SQLite/CoreData")]
  end
 subgraph User_Device["Mobile Device Boundary"]
    direction TB
        UI["User Interface<br>React Native"]
        Local_Security
        App_Logic
  end
 subgraph Core_Services["Microservices Containerized"]
        Issuer_Svc["Issuance Service"]
        Verifier_Svc["Verification Service"]
        Revocation_Svc["Revocation Service"]
        Logs["Admin/Audit Logs<br>Structured JSON"]
  end
 subgraph Cloud_Infra["QuantumZero Backend Infrastructure"]
    direction TB
        Gateway["API Gateway<br>TLS 1.3 Termination"]
        Core_Services
        Trust_Reg[("Trust Registry /<br>Ledger Simulation")]
  end
    User(("User / Holder")) -- Biometric/PIN Auth --> UI
    UI --> DID_Mod
    DID_Mod -- Generate/Sign Keys --> SE
    SE -. Private Keys Never Leave .-> SE
    DID_Mod -- Store VCs --> Local_DB
    DID_Mod -- Generate Proof --> ZKP_Gen
    DID_Mod <-- HTTPS / DIDComm --> Gateway
    Gateway --> Issuer_Svc & Verifier_Svc & Revocation_Svc
    Issuer_Svc --> Trust_Reg
    Verifier_Svc --> Trust_Reg
    Revocation_Svc --> Trust_Reg
    Core_Services --> Logs
    Ext_Verifier(("External Verifier")) -- Scan QR / Offline --> UI
    Ext_Verifier -- Verify DID Status --> Gateway

     SE:::security
     DID_Mod:::mobile
     ZKP_Gen:::mobile
     Local_DB:::database
     UI:::mobile
     Issuer_Svc:::cloud
     Verifier_Svc:::cloud
     Revocation_Svc:::cloud
     Logs:::cloud
     Gateway:::cloud
     Trust_Reg:::database
     User:::external
     Ext_Verifier:::external
    classDef mobile fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef cloud fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef database fill:#e0f2f1,stroke:#004d40,stroke-width:2px
    classDef external fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef security fill:#ffebee,stroke:#b71c1c,stroke-width:2px,stroke-dasharray: 5 5