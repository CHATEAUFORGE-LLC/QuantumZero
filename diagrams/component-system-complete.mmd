---
title: Component Diagram - Complete QuantumZero System Architecture
config:
  theme: base
---
%% QuantumZero UML palette note: actors/external=#fff7e6/#b45309, system/component=#e0f2fe/#075985, datastore=#ecfccb/#4d7c0f, notes=#fff9c4/#d97706. Aligns diagrams to Deliverable 1 UML/DFD theme.
flowchart LR
    %% QuantumZero UML palette (standardized)
    classDef actor fill:#fff7e6,stroke:#b45309,stroke-width:2px
    classDef system fill:#eef2ff,stroke:#4338ca,stroke-width:2px
    classDef component fill:#e0f2fe,stroke:#075985,stroke-width:2px
    classDef service fill:#e8f5e9,stroke:#166534,stroke-width:2px
    classDef datastore fill:#ecfccb,stroke:#4d7c0f,stroke-width:2px
    classDef optional fill:#f3f4f6,stroke:#6b7280,stroke-width:2px,stroke-dasharray: 5 3

    %% Mobile Application Components
    subgraph MobileApp["<<system>> QuantumZero Mobile Application"]
        direction TB
        UILayer["<<component>> Presentation (Flutter screens)"]:::component
        StateLayer["<<component>> State Management (Riverpod)"]:::component
        BusinessLayer["<<component>> Business Logic (Repositories)"]:::component
        ServicesLayer["<<component>> Core Services"]:::component
        ModelsLayer["<<component>> Domain Models (Did, Credential, VP)"]:::component
    end

    %% Platform Components
    subgraph Platform["<<system>> Platform Services"]
        direction LR
        iOS["<<component>> iOS Platform<br/>Keychain, Secure Enclave"]:::component
        Android["<<component>> Android Platform<br/>Keystore, StrongBox"]:::component
    end

    %% Server Components
    subgraph ServerApp["<<system>> QuantumZero Server"]
        direction TB
        AdminAPI["<<component>> Admin API<br/>Actix-Web 4.9 (:8080)"]:::service
        WebFrontend["<<component>> Web Frontend<br/>Actix Files (:3000)"]:::component
        Common["<<component>> qz-common"]:::component
        IndyClient["<<component>> qz-indy-client"]:::component

        %% API surface
        Gateway["<<component>> API Gateway<br/>TLS termination (TLS 1.3)"]:::component
        IssuanceAPI["<<component>> Issuance API"]:::service
        VerificationAPI["<<component>> Verification API"]:::service
        RevocationAPI["<<component>> Revocation API"]:::service
    end

    %% Data Storage
    subgraph DataLayer["<<system>> Data Layer"]
        LocalDB[("<<database>> Local SQLite (sqflite)<br/>mobile wallet storage")]:::datastore
        PostgreSQL[("<<database>> PostgreSQL 16<br/>Admin API persistence")]:::datastore
        LedgerBrowser[("<<component>> Ledger Browser (VON)<br/>HTTP :8000 / host :9000")]:::datastore
        IndyPool[("<<component>> Indy Node Pool<br/>node1..node4")]:::datastore

        TrustedRegistryDB[("<<database>> Trusted Registry DB (LedgerDB) (optional)<br/>schema reference: QuantumZero-server/ledgerDB")]:::optional
        AuditLogs[("<<database>> Admin/Audit Logs<br/>Structured JSON")]:::datastore
    end

    %% External
    subgraph External["External Actors"]
        direction TB
        AdminUser(("Admin User (Browser)")):::actor
        Holder(("Holder / Wallet User")):::actor
        Verifier(("Verifier / Relying Party")):::actor
    end

    %% Component Dependencies
    UILayer -->|observes| StateLayer
    StateLayer -->|uses| BusinessLayer
    BusinessLayer -->|uses| ServicesLayer
    BusinessLayer -->|manages| ModelsLayer
    ServicesLayer -->|platform bindings| Platform

    ServicesLayer -->|secure keys| iOS
    ServicesLayer -->|secure keys| Android
    BusinessLayer -->|persist| LocalDB

    AdminUser -->|HTTP| WebFrontend
    AdminUser -->|HTTP /api/v1/*| AdminAPI
    AdminUser -->|HTTPS| Gateway
    Gateway --> AdminAPI
    Gateway --> IssuanceAPI
    Gateway --> VerificationAPI
    Gateway --> RevocationAPI

    AdminAPI --> Common
    AdminAPI --> IndyClient

    AdminAPI --> PostgreSQL
    IndyClient --> LedgerBrowser
    LedgerBrowser --> IndyPool

    IssuanceAPI -. ledger access .-> IndyClient
    VerificationAPI -. ledger access .-> IndyClient
    RevocationAPI -. ledger access .-> IndyClient

    AdminAPI -. audit .-> AuditLogs
    IssuanceAPI -. audit .-> AuditLogs
    VerificationAPI -. audit .-> AuditLogs
    RevocationAPI -. audit .-> AuditLogs

    %% Trust registry schema is documented by ERD/DFD diagrams.
    AdminAPI -. trust registry .-> TrustedRegistryDB
    IssuanceAPI -. trust registry .-> TrustedRegistryDB
    VerificationAPI -. trust registry .-> TrustedRegistryDB
    RevocationAPI -. trust registry .-> TrustedRegistryDB

    Holder --- UILayer
    Verifier --- UILayer
