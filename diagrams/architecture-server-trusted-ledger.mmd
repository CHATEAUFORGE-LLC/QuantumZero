---
title: Architecture - Indy Ledger Integration (Current + Planned APIs)
config:
  theme: base
---
%% QuantumZero UML palette note: actors/external=#fff7e6/#b45309, system/component=#e0f2fe/#075985, datastore=#ecfccb/#4d7c0f, notes=#fff9c4/#d97706. Aligns diagrams to Deliverable 1 UML/DFD theme.
flowchart LR
    %% QuantumZero UML palette (standardized)
    classDef actor fill:#fff7e6,stroke:#b45309,stroke-width:2px
    classDef system fill:#eef2ff,stroke:#4338ca,stroke-width:2px
    classDef component fill:#e0f2fe,stroke:#075985,stroke-width:2px
    classDef service fill:#e8f5e9,stroke:#166534,stroke-width:2px
    classDef datastore fill:#ecfccb,stroke:#4d7c0f,stroke-width:2px

    %% Admin flows
    Admin(("Admin User")):::actor
    Verifier(("Verifier / Relying Party")):::actor
    Issuer(("Issuer System / Operator")):::actor

    subgraph QZ["<<system>> QuantumZero Server"]
        direction TB
        Web["<<component>> Web Frontend<br/>static SPA"]:::component
        Gateway["<<component>> API Gateway (Planned)<br/>TLS termination (TLS 1.3 requirement)"]:::component
        AdminAPI["<<service>> Admin API (Current)<br/>Actix-Web + SQLx"]:::service
        IssuanceAPI["<<service>> Issuance API (Planned)"]:::service
        VerificationAPI["<<service>> Verification API (Planned)"]:::service
        RevocationAPI["<<service>> Revocation API (Planned)"]:::service
        DB[("PostgreSQL 16")]:::datastore
        IndyClient["<<component>> qz-indy-client<br/>HTTP client"]:::component
    end

    subgraph Indy["<<system>> Indy Ledger Stack (Docker network: indy)"]
        direction TB
        Browser["<<component>> Ledger Browser (VON)<br/>HTTP :8000 (container)"]:::component
        subgraph Pool["<<system>> Indy Node Pool"]
            direction LR
            Node1["node1"]:::component
            Node2["node2"]:::component
            Node3["node3"]:::component
            Node4["node4"]:::component
        end
    end

    %% Interactions (current implementation)
    Admin --> Web
    Admin -->|HTTP /api/v1/*| AdminAPI
    AdminAPI --> DB
    AdminAPI --> IndyClient
    IndyClient -->|HTTP GET /ledger/*| Browser
    Browser --> Pool

    %% Planned API gateway routing
    Admin -. HTTPS .-> Gateway
    Issuer -. HTTPS .-> Gateway
    Verifier -. HTTPS .-> Gateway
    Gateway -.-> AdminAPI
    Gateway -.-> IssuanceAPI
    Gateway -.-> VerificationAPI
    Gateway -.-> RevocationAPI

    %% Planned ledger integration for additional APIs (details TBD)
    IssuanceAPI -.-> IndyClient
    VerificationAPI -.-> IndyClient
    RevocationAPI -.-> IndyClient
