---
title: DFD - Ledger Queries (Level 1)
config:
  theme: base
---
%% QuantumZero UML palette note: actors/external=#fff7e6/#b45309, system/component=#e0f2fe/#075985, datastore=#ecfccb/#4d7c0f, notes=#fff9c4/#d97706. Aligns diagrams to Deliverable 1 UML/DFD theme.
flowchart LR
    %% QuantumZero UML/DFD palette (standardized)
    classDef actor fill:#fff7e6,stroke:#b45309,stroke-width:2px
    classDef process fill:#e0f2fe,stroke:#075985,stroke-width:2px
    classDef datastore fill:#ecfccb,stroke:#4d7c0f,stroke-width:2px
    classDef external fill:#eef2ff,stroke:#4338ca,stroke-width:2px

    %% External entities
    Admin["Admin User (Browser)"]:::actor
    Ledger["Ledger Browser (VON)"]:::external

    %% Processes (Yourdon circles)
    P1(("1.0 Health & Metrics")):::process
    P2(("2.0 Query Pool Nodes")):::process
    P3(("3.0 Import Schema By ID")):::process
    P4(("4.0 Full Ledger Sync (scan)")):::process

    %% Data stores (PostgreSQL)
    D1[("D1 issuers")]:::datastore
    D2[("D2 schemas")]:::datastore
    D3[("D3 credential_definitions")]:::datastore

    %% Flows
    Admin -- GET /api/v1/health, /metrics --> P1
    P1 --> Admin
    P1 --> Ledger
    Ledger --> P1

    Admin -- GET /api/v1/ledger/pool-nodes --> P2
    P2 --> Ledger
    Ledger --> P2
    P2 --> Admin

    Admin -- POST /api/v1/schemas/import --> P3
    P3 --> Ledger
    Ledger --> P3
    P3 --> D2
    P3 --> Admin

    Admin -- POST /api/v1/sync/ledger --> P4
    P4 --> Ledger
    Ledger --> P4
    P4 --> D1
    P4 --> D2
    P4 --> D3
    P4 --> Admin
