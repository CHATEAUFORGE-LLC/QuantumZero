---
title: flowchart server issuer registry
config:
  theme: base
---
flowchart TB

%% Issuer Registry Design for Managing Trusted Credential Issuers

subgraph AdminUI["Admin Management Interface"]
  direction LR
  Dashboard["Admin Dashboard<br>View/Manage Issuers"]
  RegForm["Issuer Registration Form<br>DID, Name, Endpoints, Metadata"]
  SearchUI["Search & Lookup Interface<br>Filter by status, type, DID"]
end

subgraph APILayer["Issuer Registry API Layer"]
  direction TB
  Gateway["API Gateway<br>Authentication & Rate Limiting"]
  
  subgraph CRUD["Registry CRUD Operations"]
    direction LR
    Create["POST /issuers/register<br>Register new issuer"]
    Read["GET /issuers/{id}<br>Retrieve issuer details"]
    Update["PUT /issuers/{id}<br>Update issuer info"]
    Delete["DELETE /issuers/{id}<br>Deactivate issuer"]
    List["GET /issuers<br>List all issuers (paginated)"]
  end
  
  Lookup["GET /issuers/resolve/{did}<br>Lookup by DID"]
  Verify["POST /issuers/verify<br>Verify issuer status & credentials"]
end

subgraph CoreLogic["Registry Core Logic"]
  direction TB
  
  subgraph Validation["Issuer Validation Engine"]
    ValidateDID["Validate DID Format<br>did:key, did:web, did:indy"]
    ValidateKeys["Verify Signing Keys<br>Against DID Document"]
    ValidateMeta["Validate Metadata<br>Required fields present"]
  end
  
  Manager["Issuer Registry Manager<br>Business Logic Layer"]
  
  subgraph Status["Status Management"]
    Active["Active<br>Can issue credentials"]
    Pending["Pending<br>Awaiting approval"]
    Suspended["Suspended<br>Temporarily disabled"]
    Revoked["Revoked<br>Permanently disabled"]
  end
end

subgraph DataLayer["Data Storage Layer"]
  direction LR
  
  PrimaryDB[("Primary Registry DB<br>PostgreSQL/MongoDB<br>---<br>Issuer Profile:<br>- DID (unique)<br>- Name & Description<br>- Public Keys<br>- Service Endpoints<br>- Schema IDs allowed<br>- Status & Timestamps<br>- Admin contact info")]
  
  CacheLayer[("Redis Cache<br>Fast DID Lookups<br>Frequently accessed issuers")]
  
  AuditDB[("Audit Log<br>All registry changes<br>Admin actions<br>Status transitions")]
end

subgraph Integration["External Integration"]
  direction TB
  DIDResolver["DID Resolver<br>Resolve & verify DID documents"]
  TrustRegistry["Trust Registry<br>Cross-reference issuer status"]
  NotifySvc["Notification Service<br>Alert on status changes"]
end

%% User Flows
AdminUI --> Gateway
Gateway --> CRUD
Gateway --> Lookup
Gateway --> Verify

%% Registration Flow
Create --> Validation
Validation --> ValidateDID
Validation --> ValidateKeys
Validation --> ValidateMeta

ValidateDID --> Manager
ValidateKeys --> Manager
ValidateMeta --> Manager

Manager --> Status
Status --> PrimaryDB

%% Lookup Flow
Lookup --> CacheLayer
CacheLayer -.Cache Miss.-> PrimaryDB
PrimaryDB --> CacheLayer

Read --> CacheLayer
List --> PrimaryDB

%% Update & Delete Flow
Update --> Manager
Delete --> Manager
Manager --> PrimaryDB

%% Integration Flows
Manager --> DIDResolver
Manager --> TrustRegistry
Status --> NotifySvc

%% Audit Trail
Create --> AuditDB
Update --> AuditDB
Delete --> AuditDB
Manager --> AuditDB

%% Verification Flow
Verify --> Manager
Manager --> DIDResolver
DIDResolver -.Resolve DID Doc.-> Manager
Manager --> CacheLayer

%% Notes
Note1["Issuer Data Model:<br>---<br>{<br>  id: UUID,<br>  did: string (unique),<br>  name: string,<br>  description: string,<br>  publicKeys: array,<br>  serviceEndpoints: array,<br>  allowedSchemas: array,<br>  status: enum,<br>  metadata: object,<br>  createdAt: timestamp,<br>  updatedAt: timestamp,<br>  createdBy: adminId<br>}"]

Note2["Query Capabilities:<br>---<br>- Find by DID<br>- Find by status<br>- Find by schema support<br>- Find by issuer name<br>- List active issuers<br>- Filter & pagination"]

Note1 -.-> PrimaryDB
Note2 -.-> Manager

%% Styling
classDef admin fill:#e1f5ff,stroke:#01579b
classDef api fill:#fff3e0,stroke:#e65100
classDef logic fill:#f3e5f5,stroke:#4a148c
classDef data fill:#e8f5e9,stroke:#1b5e20
classDef external fill:#fce4ec,stroke:#880e4f

class AdminUI,Dashboard,RegForm,SearchUI admin
class APILayer,Gateway,CRUD,Create,Read,Update,Delete,List,Lookup,Verify api
class CoreLogic,Validation,Manager,Status,ValidateDID,ValidateKeys,ValidateMeta logic
class DataLayer,PrimaryDB,CacheLayer,AuditDB data
class Integration,DIDResolver,TrustRegistry,NotifySvc external
