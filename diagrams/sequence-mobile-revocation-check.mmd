---
title: Sequence Diagram - Mobile Revocation Check (Planned)
config:
  theme: base
---
%% QuantumZero UML palette note: actors/external=#fff7e6/#b45309, system/component=#e0f2fe/#075985, datastore=#ecfccb/#4d7c0f, notes=#fff9c4/#d97706. Aligns diagrams to Deliverable 1 UML/DFD theme.
sequenceDiagram
    autonumber
    participant App as Mobile Wallet
    participant Verifier as Verifier Service
    participant Cache as Revocation Cache (PostgreSQL)
    participant Registry as Revocation Source (Ledger/Status List)

    Note over App, Registry: Credential Revocation Check Flow

    App->>Verifier: presentCredential(VP, credentialID)
    activate Verifier
    
    Verifier->>Verifier: Verify Cryptographic Signature
    
    alt Signature Valid
        Verifier->>Cache: checkRevocationStatus(credentialID)
        activate Cache
        
        alt Cache Hit (Recent)
            Cache-->>Verifier: Status: Active / Revoked
        else Cache Miss / Stale
            Cache-->>Verifier: null / expired
            
            Verifier->>Registry: queryRevocationRegistry(credentialID)
            activate Registry
            Registry-->>Verifier: Current Status (Bitmask/List)
            deactivate Registry
            
            Verifier->>Cache: updateCache(status)
            activate Cache
            Cache-->>Verifier: ack
        end
        
        deactivate Cache

        alt Status == Active
            Verifier-->>App: Verification Success
        else Status == Revoked
            Verifier-->>App: Verification Failed  (Credential Revoked)
        end
        
    else Signature Invalid
        Verifier-->>App: Verification Failed  (Invalid Sig)
    end
    deactivate Verifier
