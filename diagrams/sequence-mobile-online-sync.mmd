---
title: Sequence Diagram - Mobile Online Sync
config:
  theme: base
---
sequenceDiagram
  autonumber
  participant SY as Sync Engine
  participant CACHE as Verification Cache (Local)
  participant DID as DID Doc Cache (Local)
  participant STAT as Status Cache (Local)
  participant API as Registry/Resolver APIs\n(DID + Status + Trust Lists)

  SY-->>SY: Network available trigger
  SY->>CACHE: Load stale/expired entries (by TTL)
  CACHE-->>SY: Keys to refresh (DIDs, status URLs, lists)

  SY->>API: Fetch updated DID Docs (conditional GET)
  API-->>SY: Updated docs + etags

  SY->>API: Fetch credential status updates\n(revocation lists / status endpoints)
  API-->>SY: Status deltas + timestamps

  SY->>DID: Upsert refreshed DID docs
  SY->>STAT: Upsert refreshed status entries
  SY->>CACHE: Update metadata (ttl, lastSync, etag)
