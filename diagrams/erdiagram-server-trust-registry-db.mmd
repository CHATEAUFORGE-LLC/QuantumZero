---
title: Deployment Diagram - QuantumZero Server Infrastructure
config:
  theme: base
---
erDiagram
  ISSUER ||--o{ ISSUER_DID : has
  ISSUER ||--o{ ISSUER_ENDPOINT : publishes

  TRUST_POLICY ||--o{ TRUST_POLICY_RULE : contains
  TRUST_POLICY ||--o{ TRUST_POLICY_SCOPE : scopes

  CREDENTIAL_TEMPLATE ||--o{ TEMPLATE_FIELD : defines
  TRUST_POLICY_SCOPE }o--|| CREDENTIAL_TEMPLATE : "binds template"

  ADMIN_USER ||--o{ ADMIN_USER_ROLE : has
  ADMIN_ROLE ||--o{ ADMIN_USER_ROLE : assigned
  ADMIN_USER ||--o{ AUDIT_EVENT : performs

  TRUST_POLICY ||--o{ OFFLINE_CACHE_PACKAGE : "builds"
  OFFLINE_CACHE_PACKAGE ||--o{ OFFLINE_CACHE_ITEM : contains

  ISSUER {
    uuid issuer_id PK
    text display_name
    text legal_name
    text org_type
    text status
    text trust_tier
    text notes
    timestamptz created_at
    timestamptz updated_at
  }

  ISSUER_DID {
    uuid issuer_did_id PK
    uuid issuer_id FK
    text did_indy
    text role
    boolean is_primary
    timestamptz created_at
  }

  ISSUER_ENDPOINT {
    uuid endpoint_id PK
    uuid issuer_id FK
    text endpoint_type
    text url
    boolean active
    timestamptz created_at
  }

  CREDENTIAL_TEMPLATE {
    uuid template_id PK
    text template_name
    text description
    text category
    text disclosure_policy
    boolean supports_offline
    timestamptz created_at
    timestamptz updated_at
  }

  TEMPLATE_FIELD {
    uuid field_id PK
    uuid template_id FK
    text field_name
    text display_label
    text data_type
    boolean required
    boolean reveal_by_default
    int display_order
  }

  TRUST_POLICY {
    uuid policy_id PK
    text policy_name
    text policy_version
    text status
    timestamptz effective_from
    timestamptz effective_to
    timestamptz created_at
  }

  TRUST_POLICY_RULE {
    uuid rule_id PK
    uuid policy_id FK
    text rule_type
    text subject_type
    text subject_ref
    jsonb constraint_json
    timestamptz created_at
  }

  TRUST_POLICY_SCOPE {
    uuid scope_id PK
    uuid policy_id FK
    uuid template_id FK
    text issuer_did_ref
    text schema_id_ref
    text cred_def_id_ref
    text rev_reg_id_ref
    timestamptz created_at
  }

  ADMIN_USER {
    uuid admin_user_id PK
    text username
    text display_name
    text email
    boolean is_active
    timestamptz created_at
  }

  ADMIN_ROLE {
    uuid role_id PK
    text role_name
    text description
  }

  ADMIN_USER_ROLE {
    uuid admin_user_id FK
    uuid role_id FK
  }

  AUDIT_EVENT {
    uuid event_id PK
    text event_type
    text action
    uuid actor_user_id FK
    text resource_type
    uuid resource_id
    text result
    text reason
    timestamptz occurred_at
    jsonb event_json
  }

  OFFLINE_CACHE_PACKAGE {
    uuid cache_id PK
    uuid policy_id FK
    text package_version
    text checksum
    text signature
    timestamptz generated_at
    timestamptz expires_at
  }

  OFFLINE_CACHE_ITEM {
    uuid item_id PK
    uuid cache_id FK
    text item_type
    text item_ref
    jsonb payload_json
  }
