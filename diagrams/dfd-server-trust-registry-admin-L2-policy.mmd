---
title: DFD Level 2 - Manage Trust Policies (Process 4.0 Detailed)
config:
  theme: base
---
%% DFD (Gane-Sarson) notation aligned to sample.
%% Level 2: Detailed decomposition of Process 4.0 (Manage Trust Policies). Planned capability.
flowchart TB
    classDef external fill:#fff2cc,stroke:#111111,stroke-width:1.5px
    classDef process fill:#fff2cc,stroke:#111111,stroke-width:1.5px
    classDef datastore fill:#fff2cc,stroke:#111111,stroke-width:1.5px

    Admin["Admin User"]:::external

    P31(["4.1<br>Validate Policy<br>Definition"]):::process
    P32(["4.2<br>Create Policy<br>Record"]):::process
    P33(["4.3<br>Define Policy<br>Rules"]):::process
    P34(["4.4<br>Set Policy<br>Scope"]):::process
    P35(["4.5<br>Activate/Deactivate<br>Policy"]):::process
    P36(["4.6<br>Query Policies"]):::process
    P37(["4.7<br>Emit Audit<br>Event"]):::process

    D8[["D8<br>trust_policy"]]:::datastore
    D9[["D9<br>trust_policy_rule"]]:::datastore
    D10[["D10<br>trust_policy_scope"]]:::datastore
    D11[["D11<br>audit_logs"]]:::datastore
    D12[["D12<br>users/sessions"]]:::datastore

    Admin -->|"POST /policies"| P31
    Admin -->|"PUT /policies/{id}"| P35
    Admin -->|"GET /policies"| P36

    P31 -->|"verify admin role"| D12
    P31 -->|"validated policy"| P32

    P32 -->|"policy record"| D8
    P32 -->|"policy id"| P33

    P33 -->|"rule records"| D9
    P33 -->|"policy id"| P34

    P34 -->|"scope records"| D10
    P34 -->|"policy id"| P37
    P34 -->|"policy confirmation"| Admin

    P35 -->|"current policy"| D8
    P35 -->|"updated status"| D8
    P35 -->|"status confirmation"| Admin
    P35 -->|"policy id"| P37

    P36 -->|"policy list/details"| Admin

    P37 -->|"audit record"| D11
