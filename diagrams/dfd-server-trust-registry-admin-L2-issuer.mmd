---
title: DFD Level 2 - Issuer Onboarding (Staged Approval)
config:
  theme: base
---
%% QuantumZero DFD palette: actors/external=#fff7e6/#b45309, process=#e0f2fe/#075985, datastore=#ecfccb/#4d7c0f
%% Level 2: Detailed decomposition of issuer onboarding with staging and approval
flowchart TB
    %% QuantumZero DFD palette (standardized)
    classDef actor fill:#fff7e6,stroke:#b45309,stroke-width:2px
    classDef process fill:#e0f2fe,stroke:#075985,stroke-width:2px
    classDef datastore fill:#ecfccb,stroke:#4d7c0f,stroke-width:2px

    %% External Entities
    Issuer["Issuer System"]:::actor
    Admin["Admin User"]:::actor

    %% Sub-processes
    P11(("1.1<br/>Validate<br/>Signed Request")):::process
    P12(("1.2<br/>Store<br/>Issuer Request")):::process
    P13(("1.3<br/>Review<br/>Request")):::process
    P14(("1.4<br/>Approve<br/>Issuer")):::process
    P15(("1.5<br/>Reject<br/>Issuer")):::process
    P16(("1.6<br/>Audit<br/>Event")):::process

    %% Data Stores
    D1[("D1: issuer_requests (staging)")]:::datastore
    D2[("D2: issuers (trusted registry DB)")]:::datastore
    D3[("D3: audit_logs (admin DB)")]:::datastore

    %% Issuer submission
    Issuer -->|"POST /issuer-requests"| P11
    P11 -->|"validated payload"| P12
    P12 -->|"pending request"| D1

    %% Admin review
    Admin -->|"GET /staging/issuer-requests"| P13
    D1 -.->|"pending requests"| P13
    P13 -->|"approve"| P14
    P13 -->|"reject"| P15

    %% Approval path
    P14 -->|"insert issuer"| D2
    P14 -->|"update status"| D1
    P14 -->|"approval status"| Admin

    %% Rejection path
    P15 -->|"update status"| D1
    P15 -->|"rejection status"| Admin

    %% Audit
    P14 -->|"audit event"| P16
    P15 -->|"audit event"| P16
    P16 -->|"audit record"| D3
